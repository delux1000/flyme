<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connect to My Custom RPC</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 40px auto; padding: 20px; background: #f5f5f5; }
        .rpc-url { background: #e0e0e0; padding: 10px; border-radius: 5px; word-break: break-all; }
        button { background: #3b99fc; color: white; border: none; padding: 12px 24px; border-radius: 6px; font-size: 16px; cursor: pointer; margin-top: 20px; }
        #status, #result { margin-top: 20px; padding: 10px; border-radius: 5px; white-space: pre-wrap; }
        #status { background: #fff3cd; display: none; }
        #result { background: #d4edda; }
    </style>
</head>
<body>
    <h1>üöÄ Connect to My Custom RPC</h1>
    <p>Your RPC endpoint:</p>
    <!-- REPLACE THIS URL WITH YOUR ACTUAL CLOUDFLARED TUNNEL URL -->
    <div class="rpc-url" id="rpcUrl">https://vegetation-workplace-experienced-illustrations.trycloudflare.com</div>

    <button id="connectBtn">Connect Wallet</button>
    <div id="status"></div>
    <div id="result"></div>

    <!-- Ethers and WalletConnect v2 Ethereum Provider -->
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@walletconnect/ethereum-provider@2.11.0/dist/index.umd.js"></script>
    <script>
        const rpcUrl = document.getElementById('rpcUrl').innerText;
        const projectId = "cd1a5ec0393767579e1f364ffc41597d";

        document.getElementById('connectBtn').addEventListener('click', async () => {
            const statusDiv = document.getElementById('status');
            const resultDiv = document.getElementById('result');
            statusDiv.style.display = 'block';
            statusDiv.innerText = 'Connecting...';

            try {
                // 1. Create WalletConnect provider
                const provider = await EthereumProvider.init({
                    projectId,
                    chains: [1],                // Chain ID 1 (Ethereum mainnet)
                    showQrModal: true,           // Automatically shows the QR modal
                    rpcMap: {
                        1: rpcUrl                // Map chain 1 to your custom RPC
                    },
                    methods: ['eth_sendTransaction', 'eth_sign'], // Optional: add methods you need
                    optionalMethods: ['eth_accounts'],
                });

                // 2. Wrap with ethers
                const ethersProvider = new ethers.providers.Web3Provider(provider);
                const signer = ethersProvider.getSigner();
                const address = await signer.getAddress();
                const balance = await ethersProvider.getBalance(address);

                statusDiv.style.display = 'none';
                resultDiv.innerText = `‚úÖ Connected: ${address}\nüí∞ ETH Balance: ${ethers.utils.formatEther(balance)} ETH`;
            } catch (err) {
                statusDiv.innerText = `‚ùå Error: ${err.message}`;
                console.error(err);
            }
        });
    </script>
</body>
</html>
